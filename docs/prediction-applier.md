# Prediction Applier Configuration

[â† Components](components.md) | [Installation â†’](installation.md)

> ðŸ§ª **Status: Experimental**

The Prediction Applier polls HX Insight for AI-generated predictions and applies them back to Alfresco documents as metadata. This enables automatic tagging, classification, and enrichment of documents based on HX Insight's AI analysis.

## Required Configuration

### ActiveMQ Connection

```yaml
spring:
  activemq:
    broker-url: nio://activemq:61616
```

| Environment Variable | Description |
|---------------------|-------------|
| `SPRING_ACTIVEMQ_BROKERURL` | ActiveMQ broker URL |

### Alfresco Repository

```yaml
alfresco:
  repository:
    base-url: http://alfresco:8080/alfresco
    discovery-endpoint: http://alfresco:8080/alfresco/api/discovery
```

| Environment Variable | Description |
|---------------------|-------------|
| `ALFRESCO_REPOSITORY_BASEURL` | Alfresco REST API base URL (for applying predictions) |
| `ALFRESCO_REPOSITORY_DISCOVERYENDPOINT` | Alfresco Discovery API endpoint (for version detection) |

### HX Insight Predictions

```yaml
hyland-experience:
  insight:
    predictions:
      base-url: https://hxinsight.hyland.com
      poll-period-millis: 60000
      buffer-endpoint: activemq:queue:predictions-buffer
```

| Environment Variable | Description | Default |
|---------------------|-------------|---------|
| `HYLANDEXPERIENCE_INSIGHT_PREDICTIONS_BASEURL` | HXI Predictions API base URL (provided by Hyland) | - |
| `HYLANDEXPERIENCE_INSIGHT_PREDICTIONS_POLLPERIODMILLIS` | How often to poll for new predictions (milliseconds) | - |
| `HYLANDEXPERIENCE_INSIGHT_PREDICTIONS_BUFFERENDPOINT` | ActiveMQ queue for buffering predictions | `activemq:queue:predictions-buffer` |

> **Note:** Either `poll-period-millis` or `collector-timer-endpoint` must be set to enable prediction polling.

### Authentication

```yaml
auth:
  providers:
    hyland-experience:
      type: oauth2
      client-id: <your-client-id>
      client-secret: <your-client-secret>
      token-uri: https://auth.hyland.com/oauth/token
      environment-key: <your-env-key>
    alfresco:
      type: basic
      username: admin
      password: admin
```

| Environment Variable | Description |
|---------------------|-------------|
| `AUTH_PROVIDERS_HYLANDEXPERIENCE_CLIENTID` | HXI OAuth client ID |
| `AUTH_PROVIDERS_HYLANDEXPERIENCE_CLIENTSECRET` | HXI OAuth client secret |
| `AUTH_PROVIDERS_HYLANDEXPERIENCE_TOKENURI` | HXI OAuth token endpoint |
| `AUTH_PROVIDERS_HYLANDEXPERIENCE_ENVIRONMENTKEY` | HXI environment key (identifies your tenant) |
| `AUTH_PROVIDERS_ALFRESCO_USERNAME` | Alfresco admin username (needs write access) |
| `AUTH_PROVIDERS_ALFRESCO_PASSWORD` | Alfresco admin password |

---

## How It Works

1. **Poll** - The applier periodically polls HX Insight for new predictions
2. **Buffer** - Predictions are buffered in an ActiveMQ queue for reliable processing
3. **Apply** - Each prediction is applied to the corresponding Alfresco document via REST API
4. **Confirm** - Success/failure is reported back to HX Insight

### Prediction Types

The applier can handle various prediction types generated by HX Insight's AI models:
- Document classification
- Entity extraction
- Sentiment analysis
- Custom ML model outputs

---

## Logging

```yaml
logging:
  level:
    org.alfresco: INFO
```

| Environment Variable | Description |
|---------------------|-------------|
| `LOGGING_LEVEL_ORG_ALFRESCO` | Log level for connector classes |

Set to `DEBUG` to see detailed prediction processing information.
